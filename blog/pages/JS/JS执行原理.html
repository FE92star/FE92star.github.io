<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS执行原理 | 技术-自由浪漫之风</title>
    <meta name="description" content="技术之路">
    <link rel="icon" href="/blog/icons/love.png">
    
    <link rel="preload" href="/blog/assets/css/0.styles.c6091785.css" as="style"><link rel="preload" href="/blog/assets/js/app.884acb3b.js" as="script"><link rel="preload" href="/blog/assets/js/4.422329df.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.113de41f.js"><link rel="prefetch" href="/blog/assets/js/11.e3bf184e.js"><link rel="prefetch" href="/blog/assets/js/12.b331b0f0.js"><link rel="prefetch" href="/blog/assets/js/13.b224f2a5.js"><link rel="prefetch" href="/blog/assets/js/14.31cf5509.js"><link rel="prefetch" href="/blog/assets/js/15.588f059f.js"><link rel="prefetch" href="/blog/assets/js/16.49c453a4.js"><link rel="prefetch" href="/blog/assets/js/17.f876f2a9.js"><link rel="prefetch" href="/blog/assets/js/18.ce928cb0.js"><link rel="prefetch" href="/blog/assets/js/19.5fd43703.js"><link rel="prefetch" href="/blog/assets/js/2.bc129dda.js"><link rel="prefetch" href="/blog/assets/js/20.66b928fd.js"><link rel="prefetch" href="/blog/assets/js/21.45855ac6.js"><link rel="prefetch" href="/blog/assets/js/22.b7244131.js"><link rel="prefetch" href="/blog/assets/js/23.5bd1bc36.js"><link rel="prefetch" href="/blog/assets/js/24.77227573.js"><link rel="prefetch" href="/blog/assets/js/25.4082056c.js"><link rel="prefetch" href="/blog/assets/js/26.e40e5da5.js"><link rel="prefetch" href="/blog/assets/js/27.86aeb6e8.js"><link rel="prefetch" href="/blog/assets/js/28.c80c37a2.js"><link rel="prefetch" href="/blog/assets/js/29.50ac3a4f.js"><link rel="prefetch" href="/blog/assets/js/3.bdeb5786.js"><link rel="prefetch" href="/blog/assets/js/30.f1814715.js"><link rel="prefetch" href="/blog/assets/js/5.503f33e1.js"><link rel="prefetch" href="/blog/assets/js/6.cd4a4589.js"><link rel="prefetch" href="/blog/assets/js/7.a17cd809.js"><link rel="prefetch" href="/blog/assets/js/8.e2a0ac56.js"><link rel="prefetch" href="/blog/assets/js/9.2d78aefb.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.c6091785.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">技术-自由浪漫之风</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">list</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/list/list1.html" class="nav-link">list1</a></li><li class="dropdown-item"><!----> <a href="/blog/list/list2.html" class="nav-link">list2</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MbMin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">list</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/list/list1.html" class="nav-link">list1</a></li><li class="dropdown-item"><!----> <a href="/blog/list/list2.html" class="nav-link">list2</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MbMin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>原生JS</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/blog/pages/JS/JS执行原理.html" class="active sidebar-link">JS执行原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/JS/JS执行原理.html#js是单线程语言" class="sidebar-link">JS是单线程语言</a></li><li class="sidebar-sub-header"><a href="/blog/pages/JS/JS执行原理.html#浏览器是多进程的应用程序" class="sidebar-link">浏览器是多进程的应用程序</a></li><li class="sidebar-sub-header"><a href="/blog/pages/JS/JS执行原理.html#浏览器渲染进程" class="sidebar-link">浏览器渲染进程</a></li><li class="sidebar-sub-header"><a href="/blog/pages/JS/JS执行原理.html#js代码的执行顺序" class="sidebar-link">JS代码的执行顺序</a></li><li class="sidebar-sub-header"><a href="/blog/pages/JS/JS执行原理.html#异步任务包含宏任务和微任务" class="sidebar-link">异步任务包含宏任务和微任务</a></li><li class="sidebar-sub-header"><a href="/blog/pages/JS/JS执行原理.html#案例分析" class="sidebar-link">案例分析</a></li></ul></li><li><a href="/blog/pages/JS/关于this指向.html" class="sidebar-link">this指向问题</a></li><li><a href="/blog/pages/JS/原生API.html" class="sidebar-link">原生常用API总结</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Git操作</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Flutter</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>学习资源</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>前端自检</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="js执行原理"><a href="#js执行原理" aria-hidden="true" class="header-anchor">#</a> JS执行原理</h1> <h2 id="js是单线程语言"><a href="#js是单线程语言" aria-hidden="true" class="header-anchor">#</a> JS是<code>单线程</code>语言</h2> <ul><li>JS的执行是按照语句出现的先后顺序执行的，即同步执行</li> <li>单线程的原因：防止多次操作同一个DOM，并且是矛盾的操作，导致无法判断谁有决定权</li></ul> <h3 id="线程和进程的区别"><a href="#线程和进程的区别" aria-hidden="true" class="header-anchor">#</a> <code>线程</code>和<code>进程</code>的区别</h3> <ol><li>进程：从计算机硬件执行角度上考虑，所有的程序执行都需要<code>CPU</code>的调控和运行，在某个程序A执行的过程中，CPU需要先加载其所需要的<code>上下文环境</code>，运行程序，最后保存其上下文环境的整个执行时间的总和</li> <li>线程：指在一个进程下的更细小的CPU时间段，线程共享一个进程的上下文环境</li> <li>一般情况一个进程可以包含多个线程</li></ol> <h2 id="浏览器是多进程的应用程序"><a href="#浏览器是多进程的应用程序" aria-hidden="true" class="header-anchor">#</a> 浏览器是<code>多进程</code>的应用程序</h2> <ol><li>Browser进程</li> <li>第三方插件进程</li> <li>GPU进程</li> <li>浏览器渲染进程</li></ol> <ul><li>采用多进程的优势：避免单个进程崩溃导致整个浏览器的崩溃，互相直接隔离不干扰</li> <li>和前端渲染有关的进程是浏览器渲染进程</li></ul> <h2 id="浏览器渲染进程"><a href="#浏览器渲染进程" aria-hidden="true" class="header-anchor">#</a> 浏览器渲染进程</h2> <ul><li>包含多个线程：
<ol><li>GUI渲染线程</li> <li>JS引擎线程</li> <li>事件触发线程</li> <li>定时器触发线程</li> <li>异步http请求线程</li></ol></li> <li>其中GUI和JS引擎为互斥线程，因此JS的解析会<code>阻塞</code>页面的渲染</li></ul> <h2 id="js代码的执行顺序"><a href="#js代码的执行顺序" aria-hidden="true" class="header-anchor">#</a> JS代码的执行顺序</h2> <ul><li>任务进入<code>执行栈</code>：
<ol><li>同步任务——主线程-执行完毕主线程为空的时候开始读取队列的函数-推到主线程执行栈执行</li> <li>异步任务——<code>Event Table</code>-注册对应回调函数-事件触发将任务置于<code>Event Queue</code></li> <li>主线程任务执行结束空闲时，开始查询Event Queue中是否有等待的异步任务，如果有则进入到主线程中执行</li> <li>整个流程就一直循环进行。</li></ol></li></ul> <h2 id="异步任务包含宏任务和微任务"><a href="#异步任务包含宏任务和微任务" aria-hidden="true" class="header-anchor">#</a> 异步任务包含<code>宏任务</code>和<code>微任务</code></h2> <ul><li>宏任务是值一般等待的耗时时间比较久的任务，包含以下：
<code>setTimeout</code>、<code>MessageChannel</code>、<code>postMessage</code>、<code>setImmediate</code></li> <li>微任务指的是耗时短，迅速执行的任务，包含以下：
<code>MutationObsever</code>、<code>Promise.then</code>等</li> <li>两者之间的关系是：
先执行一个宏任务，执行结束之后再查看队列中是否有等待执行的微任务，如果有，将对应的所有等待的微任务全部执行完毕，一次事件循环结束，进入下一个宏任务，具体流程如下图所示：
<img src="/blog/assets/img/loop.5269fc0a.png" alt="avatar"></li></ul> <h2 id="案例分析"><a href="#案例分析" aria-hidden="true" class="header-anchor">#</a> 案例分析</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">333</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//返回的先后顺序是：222=&gt;444=&gt;333=&gt;111</span>
  <span class="token comment">// 主线程任务(第一次宏任务)=&gt;执行注册的微任务then</span>
  <span class="token comment">// =&gt;执行第二个宏任务setTimeout</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/blog/assets/js/app.884acb3b.js" defer></script><script src="/blog/assets/js/4.422329df.js" defer></script>
  </body>
</html>
